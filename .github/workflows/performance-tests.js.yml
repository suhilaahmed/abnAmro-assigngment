name: k6 Load Testing

on: [push]

jobs:
  loadTest:
    runs-on: ubuntu-latest
    defaults:
      run:
         working-directory: ./k6-performance-testing
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Run up k6
      uses: k6io/action@v0.1
      env: 
        test_mode: ${{secrets.test_mode}}
        token: ${{secrets.PRIVATE_ACCESS_TOKEN}}
      with:
        filename: ./k6-performance-testing/issuesApi.js


    # - name: Run k6 test
    #   uses: k6io/action@v0.1
    #   run: k6 run -e test_mode=${{secrets.test_mode}} issuesApi.js -e token=${{secrets.PRIVATE_ACCESS_TOKEN}}
